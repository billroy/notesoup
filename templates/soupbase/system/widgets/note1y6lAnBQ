{"syncme":true,"xPos":798,"from":"system in system/widgets","width":250,"imports":"http://chowder.notesoup.net/js-src/js-widgets/uploadForm.js","yPos":216,"height":130,"zIndex":17,"bgcolor":"#ccffcc","text":"<script type='text/javascript'>\n/**\n*\tuploadForm.js - Note Soup file upload widget\n*\tCopyright 2007 by Bill Roy\n*\tAll rights reserved.\n*/\nvar note = notesoup.ui.getEnclosingNote(this);\nnote.set({\n\n\thandleResponse: function(elt, success, response) {\n\t\t//notesoup.say('Upload status: ' + elt.id + ' ' + success + ' ' + response.responseText);\n\t\tthis.setContentDiv(response.responseText);\n\t\tthis.show.createDelegate(this).defer(3000);\n\t\tnotesoup.sendSync();\n\t},\n\n\tsubmitForm: function() {\n\t\tvar form = this.getEphemeral('uploadForm').getForm();\n\t\tif (form) {\n\t\t\tvar el = form.el.dom;\n\t\t\tif (el) {\n\t\t\t\tel.setAttribute('enctype', 'multipart/form-data');\n\t\t\t\ttry {\n\t\t\t\t\tformManager = new Ext.UpdateManager(el);\n\t\t\t\t\tformManager.formUpdate(el, '/upload', true, this.handleResponse.createDelegate(this));\n\t\t\t\t\tthis.showLoading();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tnotesoup.say('form submission error: ' + notesoup.dump(e));\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\t\t\n\t},\n\n\tonrender: function() {\n\n\t\tvar uploadForm = new Ext.FormPanel({\n\n\t\t\tlabelAlign: 'right',\n\t\t\tfileUpload: true,\n\t\t\tlabelWidth: 75,\n\t\t\twidth: this.width - 36,\n\t\t\tbodyStyle: 'background:' + (this.bgcolor || notesoup.ui.defaultNoteColor),\n\t\t\tborder: false,\n\t\t\tbodyBorder: false,\n\t\t\titems: [{\n\t\t\t\txtype: 'textfield',\n\t\t\t\tid: this.getFieldID('thefile'),\n\t\t\t\tallowBlank: false,\n\t\t\t\tinputType: 'file',\n\t\t\t\tname: 'thefile',\n\t\t\t\tfieldLabel: 'File to upload',\n\t\t\t\twidth: 300\n\t\t\t}],\n\t\t\tbuttons: [{\n\t\t\t\ttext: 'Upload',\n\t\t\t\thandler: this.submitForm,\n\t\t\t\tscope: this\n\t\t\t},{\n\t\t\t\ttext: 'Done', \n\t\t\t\thandler: this.destroy,\n\t\t\t\tscope: this\n\t\t\t}],\n\t\t\tkeys: [{\n\t\t\t\tkey: 13,\n\t\t\t\tfn: this.submitForm,\n\t\t\t\tscope: this\n\t\t\t}]\n\t\t});\n\t\tthis.setContentDiv('<br/>');\n\t\tuploadForm.render(this.getContentDiv());\n\t\tthis.setEphemeral('uploadForm', uploadForm);\n\t}\n});\nnote.show();\n</script>\nLoading...","notename":"File Upload","mtime":1203791184,"id":"note1y6lAnBQ"}