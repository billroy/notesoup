{"syncme":true,"xPos":325,"from":"system from system/widgets","bgcolor":"#ccffcc","imports":"http://chowder.notesoup.net/js-src/js-widgets/folderacl.js","mtime":1203791081.000000,"yPos":175,"height":55,"width":250,"notename":"Folder Access Control","text":"<script type='text/javascript'>\n/**\n*\tfolderacl.js - Note Soup folder permissions UI\n*\tCopyright 2007, 2008 by Bill Roy\n*\tAll rights reserved.\n*/\nvar note = notesoup.ui.getEnclosingNote(this);\nnote.set({\n\tnotename: 'Folder Access Control',\n\t//bgcolor: '#99ccff',\n\n\tinit: function() {\n\t\tthis.show();\n\t\tthis.refresh();\n\t},\n\n\tgetdata: function(key) {\n\t\tif ('folderacl' in notesoup) return notesoup.folderacl[key];\n\t\treturn '';\n\t},\n\n\tonrender: function() {\n\t\n\t\tif (!notesoup.isowner) {\n\t\t\tthis.setContentDiv([\n\t\t\t\t'<center><br/>',\n\t\t\t\t'Sorry, only the folder owner has permission to change access rights here.<br/>',\n\t\t\t\t'<br/>',\n\t\t\t\t'</center>'\n\t\t\t].join(''));\n\t\t\treturn;\n\t\t}\n\t\n\t\tvar folderACLForm = new Ext.FormPanel({\n\t\t\tlabelWidth: 70,\n\t\t\tminButtonWidth: 50 ,\n\t\t\tbodyStyle: 'background:' + (this.bgcolor || notesoup.ui.defaultNoteColor),\n\t\t\tborder: false,\n\t\t\tbodyBorder: false,\n\t\t\titems: [{\n\t\t\t\txtype: 'textfield',\n\t\t\t\tfieldLabel: 'Folder',\n\t\t\t\tid: this.getFieldID('folder'),\n\t\t\t\tname: 'folder',\n\t\t\t\tvalue: this.getdata('folder'),\n\t\t\t\twidth: this.width - 36 - 76\n\t\t\t},{\n\t\t\t\txtype: 'textarea',\n\t\t\t\tfieldLabel: 'Read',\n\t\t\t\tid: this.getFieldID('readers'),\n\t\t\t\tname: 'readers',\n\t\t\t\tvalue: this.getdata('readers'),\n\t\t\t\twidth: this.width - 36 - 76\n\t\t\t},{\n\t\t\t\txtype: 'textarea',\n\t\t\t\tfieldLabel: 'Write',\n\t\t\t\tid: this.getFieldID('editors'),\n\t\t\t\tname: 'editors',\n\t\t\t\tvalue: this.getdata('editors'),\n\t\t\t\twidth: this.width - 36 - 76\n\t\t\t},{\n\t\t\t\txtype: 'textarea',\n\t\t\t\tfieldLabel: 'Append',\n\t\t\t\tid: this.getFieldID('senders'),\n\t\t\t\tname: 'senders',\n\t\t\t\tvalue: this.getdata('senders'),\n\t\t\t\twidth: this.width - 36 - 76\n\t\t\t}],\n\t\t\tbuttons: [{\n\t\t\t\ttext: 'save',\n\t\t\t\thandler: this.saveACL,\n\t\t\t\tscope: this\n\t\t\t},{\n\t\t\t\ttext: 'refresh',\n\t\t\t\thandler: this.refresh,\n\t\t\t\tscope: this\n\t\t\t},{\n\t\t\t\ttext: 'done',\n\t\t\t\thandler: this.destroy,\n\t\t\t\tscope: this\n\t\t\t}]\n\t\t});\n\n\t\tthis.setContentDiv('<br/>');\n\t\tfolderACLForm.render(this.getContentDiv());\n\t\tthis.setEphemeral('folderACLForm', folderACLForm);\n\t\t//this.onrender = this.renderform;\n\t\treturn folderACLForm;\n\t},\n\n\tsaveACL: function() {\n\t\tnotesoup.setFolderACL(this.getField('folderACLForm', 'folder'), {\n\t\t\t'senders': this.getField('folderACLForm', 'senders'),\n\t\t\t'readers': this.getField('folderACLForm', 'readers'),\n\t\t\t'editors': this.getField('folderACLForm', 'editors')\n\t\t});\n\t},\n\n\tupdateValues: function() {\n\t\tthis.setField('folderACLForm', 'folder', notesoup.folderacl.folder);\n\t\tthis.setField('folderACLForm', 'senders', notesoup.folderacl.senders);\n\t\tthis.setField('folderACLForm', 'readers', notesoup.folderacl.readers);\n\t\tthis.setField('folderACLForm', 'editors', notesoup.folderacl.editors);\n\t},\n\t\n\trefresh: function() {\n\t\tif (!notesoup.isowner) return;\n\t\tvar folder = notesoup.foldername;\n\t\tvar theForm = this.getEphemeral('folderACLForm');\n\t\tif (theForm) {\n\t\t\tvar f = this.getField('folderACLForm', 'folder');\n\t\t\tif (f) folder = f;\n\t\t}\n\t\tnotesoup.getFolderACL(folder, note.updateValues, notesoup.notes[note.id]);\n\t}\n});\nnote.init();\n</script>\nLoading...","id":"noteV1UIy0ow"}