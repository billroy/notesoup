{"xPos":794,"from":"widgets from widgets/flickrlab","width":"250","text":"<script type='text/javascript'>\n/**\n*\tcalculator.js - Note Soup calculator widget\n*\tCopyright 2007 by Bill Roy\n*\tAll rights reserved.\n*/\nvar note = notesoup.ui.getEnclosingNote(this);\nnote.set({\n\tonrender: function() {\n\t\tvar calculatorForm = new Ext.form.Form({\n\t\t\tlabelWidth: 75,\n\t\t\thideLabels: false\n\t\t});\n\n\t\tif (this.formula && (this.formula.length > 40)) calculatorForm.add(new Ext.form.TextArea({\n\t\t\tfieldLabel: 'Formula',\n\t\t\tid: 'formula-' + this.id,\n\t\t\t//grow: true,\n\t\t\t//growMin: 12,\n\t\t\tname: 'formula',\n\t\t\tvalue: this.formula,\n\t\t\twidth: this.width - 36 - 86\n\t\t}));\n\t\telse calculatorForm.add(new Ext.form.TextField({\n\t\t\tfieldLabel: 'Formula',\n\t\t\tid: 'formula-' + this.id,\n\t\t\tname: 'formula',\n\t\t\tvalue: this.formula,\n\t\t\twidth: this.width - 36 - 86\n\t\t}));\n\n\t\tcalculatorForm.add(\n\t\t\tnew Ext.form.TextField({\n\t\t\t\tfieldLabel: 'Value',\n\t\t\t\tid: 'value-' + this.id,\n\t\t\t\tname: 'value',\n\t\t\t\tvalue: this.value,\n\t\t\t\twidth: this.width - 36 - 86\n\t\t\t}),\n\t\t\tnew Ext.form.Checkbox({\n\t\t\t\tfieldLabel: 'Auto recalc',\n\t\t\t\tchecked: this.autorecalc,\n\t\t\t\tname: 'autorecalc'\n\t\t\t})\n\t\t);\n\t\tcalculatorForm.addButton({\n\t\t\ttext: 'calc',\n\t\t\thandler: this.calc,\n\t\t\tscope: this\n\t\t});\n\t\tcalculatorForm.addButton({\n\t\t\ttext: 'save',\n\t\t\thandler: this.saveForm,\n\t\t\tscope: this\n\t\t});\n\n\t\tthis.setContentDiv('');\n\t\tcalculatorForm.render(this.getContentDiv());\n\t\tthis.setEphemeral('calculatorForm', calculatorForm);\n\n\t\tExt.get('formula-' + this.id).on('focus', this.stop, this);\n\t\tExt.get('value-' + this.id).on('focus', this.stop, this);\n\t},\n\n\tontick: function() {\n\t\tif (this.getEphemeral('calculatorForm').getValues()['autorecalc'])\n\t\t\tthis.calc();\n\t},\n\t\n\tstart: function() {\n\t\tthis.getEphemeral('calculatorForm').setValues({'autorecalc': true});\n\t},\n\n\tstop: function() {\n\t\tthis.getEphemeral('calculatorForm').setValues({'autorecalc': false});\n\t},\n\n\tcalc: function() {\n\t\tvar theForm = this.getEphemeral('calculatorForm');\n\t\tvar v = theForm.getValues();\n\t\tthis.formula = v['formula'];\n\t\tthis.autorecalc = v['autorecalc'];\n\t\tthis.value = this.calleventhandler('formula');\n\t\ttheForm.setValues({formula: this.formula, value: this.value, autorecalc: this.autorecalc});\n\t\treturn this.value;\n\t},\n\t\n\tsaveForm: function() {\n\t\tvar theForm = this.getEphemeral('calculatorForm');\n\t\tvar v = theForm.getValues();\n\t\tthis.formula = v['formula'];\n\t\tthis.autorecalc = v['autorecalc'];\n\t\tthis.save();\n\t},\n\n\tgetvalue: function() {\n\t\treturn this.value;\n\t},\n\n\tsetvalue: function(newformula) {\n\t\tthis.formula = newformula;\n\t\treturn this.calc();\n\t}\n});\nnote.show();\n</script>","yPos":173,"value":6,"height":145,"bgcolor":"#33CCCC","autorecalc":"on","notename":"Calculator","mtime":1196598012.000000,"formula":"$n('s-2').viewtimer","sentby":"soupmaster from soupmaster/templates","id":"note3DDknT0L"}