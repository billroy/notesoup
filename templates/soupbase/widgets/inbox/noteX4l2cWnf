{"xPos":36,"from":"soupmaster from soupmaster/inbox","width":200,"ranks":[1,2,3,4,5,6],"text":"<script type='text/javascript'>\n/**\n*\tdomino.js - Note Soup dice / domino widget\n*\tCopyright 2008 by Bill Roy\n*\tAll rights reserved.\n*/\nvar note = notesoup.ui.getEnclosingNote(this);\nnote.set({\n\n\tbgcolor: '#008000',\n\n\tinit: function() {\n\t\tthis.show();\n\t\tthis.sendself.defer(1000, this, ['sync']);\n\t},\n\n\tbackImage: notesoup.imageHost + 'images/cards_png/b1fv.png',\t// or b2fv for red\n\tcolors: ['red', 'blue', 'green'],\n\tranks: [1,2,3,4,5,6],\n\n\tdominoxoffset: 150,\n\tdominoyoffset: 62,\n\tdominowidth: 98,\n\tdominoheight: 50,\n\tdominogutter: 12,\n\t//dominoheight: 76,\n\tdominocolumns: 7,\n\n\tdominoImage: function(imgname, align) {\n\t\treturn [\n\t\t\t'<img src=\"', notesoup.imageHost, 'images/dice/1d6', imgname, '.jpg\" ',\n\t\t\t\t' align=\"', (align || 'left'), '\" />'\n\t\t\t].join('');\n\t},\n\n\tcountdominoes: function() {\n\t\tcount = 0;\n\t\tfor (var n in notesoup.notes) {\n\t\t\tif (notesoup.notes[n].deckid == this.id) count++;\n\t\t}\n\t\tthis.dominocount = count;\n\t\treturn count;\n\t},\n\n\tmakedomino: function() {\n\t\tvar x = this.dominoxoffset + ((this.dominocount % this.dominocolumns) * (this.dominowidth + this.dominogutter));\n\t\tvar y = this.dominoyoffset + Math.floor(this.dominocount / this.dominocolumns) * (this.dominoheight + this.dominogutter);\n\t\t//notesoup.say('Pos: ' + x + ' ' + y);\n\n\t\tvar thedomino = this.getrandomdomino();\n\t\tif (!thedomino) return;\n\t\t \n\t\tvar dominonote = {\n\t\t\tid: 'domino' + notesoup.randomName(20), \n\t\t\tmtime: notesoup.getServerTime(),\n\t\t\trank1: thedomino.rank1,\n\t\t\tcolor1: thedomino.color1,\n\t\t\trank2: thedomino.rank2,\n\t\t\tcolor2: thedomino.color2,\n\t\t\tdeckid: this.id,\n\t\t\tnosave: true,\n\t\t\twidth: this.dominowidth,\n\t\t\theight: this.dominoheight,\n\t\t\txPos: x,\n\t\t\tyPos: y,\n\t\t\tzIndex: 0,\n\t\t\tbgcolor: 'orange',\n\t\t\ttemplate: [\n\t\t\t\tthis.dominoImage('' + this.colors[thedomino.color1] + this.ranks[thedomino.rank1], 'left'),\n\t\t\t\tthis.dominoImage('vshim', 'center'),\n\t\t\t\tthis.dominoImage('' + this.colors[thedomino.color2] + this.ranks[thedomino.rank2], 'right')\n\t\t\t\t].join('')\n\t\t};\n\t\t//alert(dominonote.template);\n\t\tthis.sendself('showdomino', dominonote);\n\t},\n\n\tshowdomino: function(thedomino) {\n\t\tnotesoup.updateNote(thedomino);\n\t},\n\n\tsnapdomino: function() {\n\t\tnotesoup.sound.play('/sound/45813__themfish__draw_card.mp3');\n\t\t//\t\t19244__deathpie__dominoDrop2.mp3');\n\t},\n\n\tdeletedomino: function(dominoid) {\n\t\tnotesoup.destroyNote(dominoid);\n\t},\n\n\tdeal: function(howmany, showing) {\n\t\tthis.sendself('snapdomino');\n\t\tthis.countdominoes();\n\t\twhile (howmany-- > 0) {\n\t\t\tthis.makedomino(showing);\n\t\t\tthis.dominocount++;\n\t\t}\n\t},\n\n\tshuffle: function() {\n\t\tnotesoup.sound.play('/sound/19245__deathpie__shuffle.mp3');\n\t\tthis.dominos = {};\n\t\tfor (var n in notesoup.notes) {\n\t\t\tif (n == this.id) continue;\n\t\t\tif (notesoup.notes[n].deckid == this.id) {\n\t\t\t\t//notesoup.say(\"Deleting domino \" + notesoup.notes[n].rank + ' ' + notesoup.notes[n].color);\n\t\t\t\tthis.sendself('deletedomino', n);\n\t\t\t}\n\t\t}\n\t},\n\t\n\tsync: function() {\n\t\tfor (var n in notesoup.notes) {\n\t\t\tif (n == this.id) continue;\n\t\t\tif (notesoup.notes[n].deckid == this.id) {\n\t\t\t\tthis.sendself('showdomino', notesoup.notes[n]);\n\t\t\t}\n\t\t}\n\t},\n\n\tgetrandomdomino: function() {\n\t\treturn {\n\t\t\tcolor1: this.random(this.colors.length), rank1: this.random(this.ranks.length),\n\t\t\tcolor2: this.random(this.colors.length), rank2: this.random(this.ranks.length),\n\t\t};\n\t},\n\n\trandom: function(max) { return Math.floor(Math.random() * max); },\n\tpick: function(list) { return '' + list[Math.floor(Math.random() * list.length)]; },\n\n\tbuttons: [\n\t\t['1 up', 'deal(1);'],\n\t\t//['1 down', 'deal(1, false);'],\n\t\t['5 up', 'deal(5);'],\n\t\t//['5 down', 'deal(5, false);'],\n\t\t['shuffle', 'shuffle();']\n\t],\n\n\tmakeButton: function(b) {\n\t\treturn [\n\t\t\t'<input type=\"submit\" value=\"', b[0], \n\t\t\t'\" onclick=\"{notesoup.ui.getEnclosingNote(this).', b[1], ';return false;}\" />'\n\t\t].join('');\n\t},\n\n\tmakeButtons: function() {\n\t\tvar o = [];\n\t\to.push('<center>');\n\t\tfor (var i=0; i < this.buttons.length; i++) {\n\t\t\to.push(this.makeButton(this.buttons[i]));\n\t\t}\n\t\to.push('</center>');\n\t\treturn o.join('');\n\t},\n\n\tonrender: function() {\n\t\tvar markup = [\n\t\t\t//'<img style=\"width:100%;\" src=\"', this.backImage, '\"/>',\n\t\t\tthis.makeButtons()\n\t\t].join('');\n\t\tthis.setContentDiv(markup);\n\t},\n\n\tface: function(upness) {\n\t\t//notesoup.say('Click! ' + color + ' ' + rank);\n\t\t//this.showing = upness;\n\t\t//this.onrender();\n\t},\n\n\tclick: function(e) {\n\t\tthis.sendself('face', !this.showing);\n\t}\n});\n//Ext.get(note.id+'_content').on('click', note.click, note);\nnote.init();\n</script>","yPos":585,"height":60,"buttons":[["1 up","deal(1);"],["5 up","deal(5);"],["shuffle","shuffle();"]],"bgcolor":"#008000","colors":["red","blue","green"],"dominoheight":50,"notename":"dominoes","dominocolumns":7,"mtime":1203961773.000000,"dominoxoffset":150,"dominoyoffset":62,"dominowidth":98,"id":"noteX4l2cWnf","backImage":"http://notesoup.net/images/cards_png/b1fv.png","dominogutter":12}