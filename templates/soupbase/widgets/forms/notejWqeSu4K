{"xPos":22,"bgcolor":"#99CCFF","text":"<script type='text/javascript'>\n/**\n*\tform.js - Note Soup generic form widget\n*\tCopyright 2007 by Bill Roy\n*\tAll rights reserved.\n*/\nvar note = notesoup.ui.getEnclosingNote(this);\nnote.set({\n\tinit: function() {\n\t\tif (!this.formfields) this.formfields = [\n\t\t\t{label: 'Notes', fieldkey: 'notes', type: 'textarea'}\n\t\t];\n\t\tthis.show();\n\t},\n\n\tgetform: function() {\n\t\tvar theForm = this.getEphemeral('myForm');\n\t\tif (!theForm) {\n\t\t\tnotesoup.say('oops getform');\n\t\t\tthis.onrender();\n\t\t\ttheForm = this.getEphemeral('myForm');\n\t\t}\n\t\treturn theForm;\n\t},\n\n\tonrender: function() {\n\t\tvar myForm = new Ext.form.Form({\n\t\t\tlabelWidth: 70,\n\t\t\tminButtonWidth: 25\n\t\t});\n\n\t\tfor (var i=0; i<this.formfields.length; i++) {\n\t\t\n\t\t\tswitch (('type' in this.formfields[i]) ? this.formfields[i].type : 'textfield') {\n\n\t\t\t\tcase 'textfield':\n\t\t\t\t\tmyForm.add(new Ext.form.TextField({\n\t\t\t\t\t\tfieldLabel: this.formfields[i].label,\n\t\t\t\t\t\tid: this.formfields[i].fieldkey + '-' + this.id,\n\t\t\t\t\t\tname: this.formfields[i].fieldkey,\n\t\t\t\t\t\tvalue: this.getdata(this.formfields[i].fieldkey),\n\t\t\t\t\t\twidth: this.width - 36 - 76\n\t\t\t\t\t}));\n\t\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase 'textarea':\n\t\t\t\t\tmyForm.add(new Ext.form.TextArea({\n\t\t\t\t\t\tfieldLabel: this.formfields[i].label,\n\t\t\t\t\t\tid: this.formfields[i].fieldkey + '-' + this.id,\n\t\t\t\t\t\tname: this.formfields[i].fieldkey,\n\t\t\t\t\t\tvalue: this.getdata(this.formfields[i].fieldkey),\n\t\t\t\t\t\twidth: this.width - 36 - 76\n\t\t\t\t\t}));\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tdefault: break;\t\t\t\n\t\t\t}\n\t\t}\n\n\t\tmyForm.addButton({\n\t\t\ttext: 'save',\n\t\t\tminWidth: 50,\n\t\t\thandler: this.savedata,\n\t\t\tscope: this\n\t\t});\n\t\tmyForm.addButton({\n\t\t\ttext: '+',\n\t\t\tminWidth: 25,\n\t\t\thandler: this.insertfield,\n\t\t\tscope: this\n\t\t});\n\n\t\tthis.setContentDiv('');\n\t\tmyForm.render(this.getContentDiv());\n\t\tthis.setEphemeral('myForm', myForm);\n\t},\n\n\tgetdata: function(key) {\n\t\tif (key in this) return this[key];\n\t\treturn '';\n\t},\n\n\tsavedata: function() {\n\t\tvar v = this.getform().getValues();\n\t\tfor (var f=0; f < this.formfields.length; f++) {\n\t\t\tthis[this.formfields[f].fieldkey] = v[this.formfields[f].fieldkey];\n\t\t}\n\t\tthis.save();\n\t},\n\n\tinsertfield: function() {\n\t\tvar newfieldlabel = notesoup.prompt('New field display label:', '');\n\t\tvar newfieldkey = notesoup.prompt('New field key:', '');\n\t\tif ((newfieldlabel.length > 0) && (newfieldkey.length > 0)) {\n\t\t\tif (!(newfieldkey in this)) this[newfieldkey] = '';\n\t\t\tthis.formfields.push({label: newfieldlabel, fieldkey: newfieldkey});\n\t\t\tthis.save();\n\t\t}\n\t},\n\n\tupdateValues: function() {\n\t\tvar newvalues = {};\n\t\tfor (var f=0; f < this.formfields.length; f++) {\n\t\t\tnewvalues[this.formfields[f].fieldkey] = this[this.formfields[f].fieldkey];\n\t\t}\n\t\tthis.getform().setValues(newvalues);\n\t}\n});\nnote.init();\n</script>","formfields":[{"fieldkey":"notes","type":"textarea","label":"Notes"}],"yPos":125,"height":135,"zIndex":8,"width":"250","notename":"Form","mtime":1196203554.698641,"sentby":"widgets from widgets/inbox","id":"notejWqeSu4K"}