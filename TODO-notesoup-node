_____       _         _____                
|   | | ___ | |_  ___ |   __| ___  _ _  ___ 
| | | || . ||  _|| -_||__   || . || | || . |
|_|___||___||_|  |___||_____||___||___||  _|
                                       |_|  
                                       
Notesoup/Node/Redis TODO list
1/25/12 -br

===

- bug: Open Folder -> list is not populated with all folders??

- bug: setup: populate the system templates directory please
- bug: setup: require a new system password

- bug: crash on access denied to widgets:race?

- bug: change note color in commandbar and make new note.  refresh.  color is gone.
	defaultbackgroundcolor issue.

- bug: button, for example: reimports clobber edited text
	(fixed.  test.)

- validfolder check in folder validation path

- acl errors in the API shouldn't go to accesserror
	- (done) send failure message
	- acl failure in openfolder should navigate, though?
	- direct navigation to an un-permitted url should get accesserror

- bug: clearing a folder permission by setting it empty fails
	- workaround: use -*
	
- client mtime handling needs review
	- widgets use it
	- dragdrop uses it
	- updatenote uses it

===
ACL support

- feat: createuser
	- need to set up folders with permissions:
		- inbox/senders/*
		- public/readers/*
		- trash/
	- need initial folder content

- bug: createuser should require systemuser OR opensignup
	- bug: should not overwrite existing user unless systemuser
	- need updateuser to update password

- bugs: other acl checks
	- double check the "prelogin" command roster for issues
	- createuser/deleteuser
	- some commands require systemuser 'us'?

===
widget issues

- bug: flickrjson widget fails on alpha box but works here
- bug: same fail on heroku
	- alpha box can't nc to bitlash.net
	- firewall problem?
	
	- problem is, it's sending back a wierd reply (bad url??)
	
	- why is it different on the EC2 host?
	- curl from the ec2 host seems to fetch it ok

http://api.flickr.com/services/feeds/photos_public.gne?tags=sunset&format=json

	bug: geturl from server at ec2 gets error page

	curl from command line here, dreamhost, ec2 all XML redirection content
	geturl from server on laptop gets json and it all works
	fetching the url in the browser works


- broken widgets
	- BUG: avatar: clicking the icon sends you to accesserror
	- porthole needs getnote
	- rss: needs /getfeed service
	- polling: generates Ext.get() error

- new widgets
	- server check widget
	- sensor widget (bitlash/arduino integration)

===
- sound is broken
	SoundManager2
		requires flash
		http://www.schillmania.com/projects/soundmanager2/doc/download/
	JPlayer
		http://www.jplayer.org/
	html5 div hack

===
Folder management

- createFolder: add "created" to folder hash on create
	- getfolderlist should use fldr/ attribute
	- deletefolder should delete fldr/attribute
	(problem? or feature? this allows for hidden folders... in other words, lost folders.)

- folder.defaultcolor should be in the attributes too?

===

API buildout 

- BUG: there is no error handling

- bug: unimplemented API:
	if method == 'getfeed': return apigetfeed(params)
	if method == 'getnote': return apigetnote(params)
		- needed for portable hole
		- can't it check the cache first?

	# Command below this point are only allowed for logged-in requestors

	if method == 'setfolderpassword': return apisetfolderpassword(params)
		- use api_setfolderacl {password: password}
		- checking the password requires http auth or equiv - how in node?

	if method == 'copyfolder': return apicopyfolder(params)
	if method == 'deleteuser': return apideleteuser(params)

	if method == 'postevent': return apipostevent(params)

===
Production 

- alpha server on http://alpha.notesoup.net:3000
	- todo: run nodejs at boot time
	- todo: server logs???
	- todo: backup .db
		- script to copy db to dbbackups/db-date
		- cron to run it

- Redis 32 bit vs 64 bit
	- next server rebuild use 32 bit

===
Notification plumbing issues

- bug: note color change doesn't go on notify bus, waits for sync instead
	- notify plumbing (tofolder...)
- bug: /say blah
	- "undefined says: blah"
	- username wiring in the message layer

- bug: need better handling for expired sessions
	- server restart kills sessions 
	- they can time out anyway
	- client thinks it's logged in
	- ...

- count/log deleted notes in erasetrash
	incr stats/notes_deleted

====
Feature candidates

- auto-expire the trash

- startup: command line option for push server on/off
	- npm install optimist

- multi-tenancy via Host: header / database index map

- notesoup time machine
	- move deleted notes somewhere 'magic'
	- infinite undo/redo
	- pushbutton backup/restore
	- privacy nightmare

===

- bug: css for note titles is different from tiny soup?!

===

Note Content and Import/Export

- BUG: node load.js and loadsoup.js don't terminate properly

- guest user: content in template/soupbase/guest
	- welcome/help
	- feat: auto-refresh every 15 minutes

- new user: content to copy in template/soupbase/newuser
	- folder permissions
===
note slinging

- dumpnotes
	- the redis-dump script is a nice temporary solution
- feat: produce notelist for doCommand/paste restore
	.getjson() does it
	- (part done: backup note does this clumsily now by popping a window)
	- make a way to copy
	- send via email would be nice too
- fishing
	grep -rl "\"id\":" . | more
	grep -rl "\"syncme\":" . | xargs edit

===

- project: SQUEEZENOTE
	- make the baseline note attributes as small as possible
	- right now they dominate the payload
	- fixup every place that uses the attributes
	- hack loadfile to map attributes
	c, x, y, w, h, t, n, z, i,
	free: abdefgjklmopqrsuv
	
	meta: id, mtime, folder, permissions

Ext v99?  Touch?  Mac?

